name: Verify All Installations

# éªŒè¯æ‰€æœ‰å¹³å°çš„å®‰è£…åŒ…æ˜¯å¦å¯ä»¥æ­£å¸¸å®‰è£…
on:
  workflow_dispatch:
    inputs:
      version:
        description: 'Version to verify (e.g., 0.1.66)'
        required: true
        type: string
      platforms:
        description: 'Platforms to verify (comma-separated or "all")'
        required: false
        default: 'all'
        type: string
  workflow_run:
    workflows: ["Release Desktop App"]
    types:
      - completed

env:
  PACKAGE_ID: novel-editor
  PACKAGE_NAME: Novel Editor

jobs:
  # è·å–ç‰ˆæœ¬å·
  get-version:
    runs-on: ubuntu-latest
    outputs:
      version: ${{ steps.version.outputs.version }}
    steps:
      - name: Checkout
        uses: actions/checkout@v4
      
      - name: Get version
        id: version
        run: |
          if [ "${{ github.event_name }}" = "workflow_dispatch" ]; then
            VERSION="${{ github.event.inputs.version }}"
          else
            VERSION=$(jq -r '.version' package.json)
          fi
          echo "version=$VERSION" >> $GITHUB_OUTPUT
          echo "ğŸ“¦ Verifying version: $VERSION"

  # ==================== Windows å¹³å° ====================
  
  # Windows MSI å®‰è£…éªŒè¯
  verify-windows-msi:
    needs: get-version
    runs-on: windows-latest
    steps:
      - name: Download and test MSI
        shell: pwsh
        run: |
          $version = "${{ needs.get-version.outputs.version }}"
          $fileName = "novel-editor_${version}_x64_zh-CN.msi"
          $url = "https://github.com/${{ github.repository }}/releases/download/desktop-v$version/$fileName"
          
          Write-Host "ğŸ“¥ Downloading MSI: $url"
          try {
            Invoke-WebRequest -Uri $url -OutFile $fileName -ErrorAction Stop
            $size = (Get-Item $fileName).Length / 1MB
            Write-Host "âœ… Downloaded: $fileName ($([math]::Round($size, 2)) MB)"
            
            # é™é»˜å®‰è£…æµ‹è¯•
            Write-Host "ğŸ”§ Testing MSI installation..."
            $proc = Start-Process msiexec.exe -ArgumentList "/i", $fileName, "/qn", "/norestart" -Wait -PassThru
            if ($proc.ExitCode -eq 0) {
              Write-Host "âœ… MSI installation successful"
              # å¸è½½
              Start-Process msiexec.exe -ArgumentList "/x", $fileName, "/qn", "/norestart" -Wait
              Write-Host "âœ… MSI uninstallation successful"
            } else {
              Write-Host "âŒ MSI installation failed: $($proc.ExitCode)"
              exit 1
            }
          } catch {
            Write-Host "âŒ Failed: $_"
            exit 1
          }

  # Windows NSIS å®‰è£…éªŒè¯
  verify-windows-nsis:
    needs: get-version
    runs-on: windows-latest
    steps:
      - name: Download and test NSIS
        shell: pwsh
        run: |
          $version = "${{ needs.get-version.outputs.version }}"
          $fileName = "novel-editor_${version}_x64-setup.exe"
          $url = "https://github.com/${{ github.repository }}/releases/download/desktop-v$version/$fileName"
          
          Write-Host "ğŸ“¥ Downloading NSIS: $url"
          try {
            Invoke-WebRequest -Uri $url -OutFile $fileName -ErrorAction Stop
            $size = (Get-Item $fileName).Length / 1MB
            Write-Host "âœ… Downloaded: $fileName ($([math]::Round($size, 2)) MB)"
            
            Write-Host "ğŸ”§ Testing NSIS installation..."
            $proc = Start-Process $fileName -ArgumentList "/S" -Wait -PassThru
            if ($proc.ExitCode -eq 0) {
              Write-Host "âœ… NSIS installation successful"
              $uninstaller = "$env:LOCALAPPDATA\novel-editor\uninstall.exe"
              if (Test-Path $uninstaller) {
                Start-Process $uninstaller -ArgumentList "/S" -Wait
                Write-Host "âœ… NSIS uninstallation successful"
              }
            } else {
              Write-Host "âŒ NSIS installation failed: $($proc.ExitCode)"
              exit 1
            }
          } catch {
            Write-Host "âŒ Failed: $_"
            exit 1
          }

  # Winget éªŒè¯
  verify-winget:
    needs: get-version
    runs-on: windows-latest
    steps:
      - name: Verify Winget package
        shell: pwsh
        run: |
          $version = "${{ needs.get-version.outputs.version }}"
          
          Write-Host "ğŸ” Checking Winget package availability..."
          
          # æœç´¢åŒ…
          $result = winget search --id Jeason.NovelEditor --accept-source-agreements 2>&1
          
          if ($result -match "Jeason.NovelEditor") {
            Write-Host "âœ… Package found in Winget"
            Write-Host $result
            
            # æ˜¾ç¤ºåŒ…ä¿¡æ¯
            winget show --id Jeason.NovelEditor --accept-source-agreements
          } else {
            Write-Host "âš  Package not yet available in Winget (may be pending review)"
            Write-Host "This is expected for new submissions"
          }

  # Chocolatey éªŒè¯
  verify-chocolatey:
    needs: get-version
    runs-on: windows-latest
    steps:
      - name: Verify Chocolatey package
        shell: pwsh
        run: |
          Write-Host "ğŸ” Checking Chocolatey package availability..."
          
          # æœç´¢åŒ…
          $result = choco search novel-editor --exact 2>&1
          
          if ($result -match "novel-editor") {
            Write-Host "âœ… Package found in Chocolatey"
            Write-Host $result
            
            # æ˜¾ç¤ºåŒ…ä¿¡æ¯
            choco info novel-editor
          } else {
            Write-Host "âš  Package not yet available in Chocolatey (may be pending review)"
          }

  # Scoop éªŒè¯
  verify-scoop:
    needs: get-version
    runs-on: windows-latest
    steps:
      - name: Verify Scoop package
        shell: pwsh
        run: |
          Write-Host "ğŸ” Checking Scoop package availability..."
          
          # å®‰è£… scoopï¼ˆå¦‚æœéœ€è¦ï¼‰
          if (-not (Get-Command scoop -ErrorAction SilentlyContinue)) {
            Write-Host "Installing Scoop..."
            Set-ExecutionPolicy RemoteSigned -Scope CurrentUser -Force
            irm get.scoop.sh | iex
          }
          
          # æœç´¢åŒ…
          $result = scoop search novel-editor 2>&1
          
          if ($result -match "novel-editor") {
            Write-Host "âœ… Package found in Scoop"
            Write-Host $result
          } else {
            Write-Host "âš  Package not found in default Scoop buckets"
            Write-Host "May need to add custom bucket"
          }

  # ==================== macOS å¹³å° ====================
  
  # macOS DMG éªŒè¯ (ARM64)
  verify-macos-arm:
    needs: get-version
    runs-on: macos-latest
    steps:
      - name: Download and test ARM64 DMG
        run: |
          VERSION="${{ needs.get-version.outputs.version }}"
          FILE="novel-editor_${VERSION}_aarch64.dmg"
          URL="https://github.com/${{ github.repository }}/releases/download/desktop-v$VERSION/$FILE"
          
          echo "ğŸ“¥ Downloading ARM64 DMG: $URL"
          if curl -L -f -o "$FILE" "$URL"; then
            SIZE=$(($(stat -f%z "$FILE") / 1024 / 1024))
            echo "âœ… Downloaded: $FILE ($SIZE MB)"
            
            echo "ğŸ”§ Testing DMG mount..."
            MOUNT=$(hdiutil attach "$FILE" -nobrowse | grep "/Volumes" | awk '{print $3}')
            if [ -n "$MOUNT" ]; then
              echo "âœ… DMG mounted: $MOUNT"
              ls -la "$MOUNT"
              hdiutil detach "$MOUNT" -quiet
              echo "âœ… DMG verification complete"
            else
              echo "âŒ Failed to mount DMG"
              exit 1
            fi
          else
            echo "âš  ARM64 DMG not available"
          fi

  # macOS DMG éªŒè¯ (x64)
  verify-macos-x64:
    needs: get-version
    runs-on: macos-13
    steps:
      - name: Download and test x64 DMG
        run: |
          VERSION="${{ needs.get-version.outputs.version }}"
          FILE="novel-editor_${VERSION}_x64.dmg"
          URL="https://github.com/${{ github.repository }}/releases/download/desktop-v$VERSION/$FILE"
          
          echo "ğŸ“¥ Downloading x64 DMG: $URL"
          if curl -L -f -o "$FILE" "$URL"; then
            SIZE=$(($(stat -f%z "$FILE") / 1024 / 1024))
            echo "âœ… Downloaded: $FILE ($SIZE MB)"
            
            echo "ğŸ”§ Testing DMG mount..."
            MOUNT=$(hdiutil attach "$FILE" -nobrowse | grep "/Volumes" | awk '{print $3}')
            if [ -n "$MOUNT" ]; then
              echo "âœ… DMG mounted: $MOUNT"
              ls -la "$MOUNT"
              hdiutil detach "$MOUNT" -quiet
              echo "âœ… DMG verification complete"
            else
              echo "âŒ Failed to mount DMG"
              exit 1
            fi
          else
            echo "âš  x64 DMG not available"
          fi

  # Homebrew éªŒè¯
  verify-homebrew:
    needs: get-version
    runs-on: macos-latest
    steps:
      - name: Verify Homebrew cask
        run: |
          echo "ğŸ” Checking Homebrew cask availability..."
          
          # æœç´¢ cask
          if brew search --cask novel-editor 2>/dev/null | grep -q "novel-editor"; then
            echo "âœ… Cask found in Homebrew"
            brew info --cask novel-editor
          else
            echo "âš  Cask not yet available in Homebrew (may be pending review)"
          fi

  # ==================== Linux å¹³å° ====================
  
  # Linux DEB éªŒè¯
  verify-linux-deb:
    needs: get-version
    runs-on: ubuntu-latest
    steps:
      - name: Download and test DEB
        run: |
          VERSION="${{ needs.get-version.outputs.version }}"
          FILE="novel-editor_${VERSION}_amd64.deb"
          URL="https://github.com/${{ github.repository }}/releases/download/desktop-v$VERSION/$FILE"
          
          echo "ğŸ“¥ Downloading DEB: $URL"
          if curl -L -f -o "$FILE" "$URL"; then
            SIZE=$(($(stat -c%s "$FILE") / 1024 / 1024))
            echo "âœ… Downloaded: $FILE ($SIZE MB)"
            
            echo "ğŸ”§ Testing DEB installation..."
            sudo apt-get update
            sudo apt-get install -y libwebkit2gtk-4.1-0 libgtk-3-0 || true
            
            if sudo dpkg -i "$FILE" 2>/dev/null || sudo apt-get install -f -y; then
              echo "âœ… DEB installation successful"
              dpkg -L novel-editor | head -10
              sudo dpkg -r novel-editor
              echo "âœ… DEB uninstallation successful"
            else
              echo "âŒ DEB installation failed"
              exit 1
            fi
          else
            echo "âŒ Failed to download DEB"
            exit 1
          fi

  # Linux AppImage éªŒè¯
  verify-linux-appimage:
    needs: get-version
    runs-on: ubuntu-latest
    steps:
      - name: Download and test AppImage
        run: |
          VERSION="${{ needs.get-version.outputs.version }}"
          FILE="novel-editor_${VERSION}_amd64.AppImage"
          URL="https://github.com/${{ github.repository }}/releases/download/desktop-v$VERSION/$FILE"
          
          echo "ğŸ“¥ Downloading AppImage: $URL"
          if curl -L -f -o "$FILE" "$URL"; then
            SIZE=$(($(stat -c%s "$FILE") / 1024 / 1024))
            echo "âœ… Downloaded: $FILE ($SIZE MB)"
            
            chmod +x "$FILE"
            if file "$FILE" | grep -q "ELF"; then
              echo "âœ… Valid ELF executable"
              ./"$FILE" --appimage-extract > /dev/null 2>&1 && echo "âœ… AppImage extraction works" || echo "âš  Extraction not supported"
            else
              echo "âŒ Invalid executable"
              exit 1
            fi
          else
            echo "âŒ Failed to download AppImage"
            exit 1
          fi

  # Snap éªŒè¯
  verify-snap:
    needs: get-version
    runs-on: ubuntu-latest
    steps:
      - name: Verify Snap package
        run: |
          echo "ğŸ” Checking Snap Store availability..."
          
          # æœç´¢ snap
          if snap find novel-editor 2>/dev/null | grep -q "novel-editor"; then
            echo "âœ… Package found in Snap Store"
            snap info novel-editor
          else
            echo "âš  Package not yet available in Snap Store"
          fi

  # Flatpak éªŒè¯
  verify-flatpak:
    needs: get-version
    runs-on: ubuntu-latest
    steps:
      - name: Verify Flatpak package
        run: |
          echo "ğŸ” Checking Flathub availability..."
          
          sudo apt-get update
          sudo apt-get install -y flatpak
          flatpak remote-add --user --if-not-exists flathub https://flathub.org/repo/flathub.flatpakrepo
          
          # æœç´¢ flatpak
          if flatpak search com.lotus.NovelEditor 2>/dev/null | grep -q "NovelEditor"; then
            echo "âœ… Package found on Flathub"
            flatpak remote-info flathub com.lotus.NovelEditor
          else
            echo "âš  Package not yet available on Flathub"
          fi

  # AUR éªŒè¯
  verify-aur:
    needs: get-version
    runs-on: ubuntu-latest
    container: archlinux:latest
    steps:
      - name: Verify AUR packages
        run: |
          echo "ğŸ” Checking AUR availability..."
          
          pacman -Syu --noconfirm curl jq
          
          # æ£€æŸ¥ novel-editor (æºç æ„å»º)
          echo "Checking novel-editor..."
          RESULT=$(curl -s "https://aur.archlinux.org/rpc/?v=5&type=info&arg=novel-editor")
          if echo "$RESULT" | jq -e '.resultcount > 0' > /dev/null; then
            echo "âœ… novel-editor found in AUR"
            echo "$RESULT" | jq '.results[0] | {name, version, description}'
          else
            echo "âš  novel-editor not found in AUR"
          fi
          
          # æ£€æŸ¥ novel-editor-bin (äºŒè¿›åˆ¶)
          echo ""
          echo "Checking novel-editor-bin..."
          RESULT=$(curl -s "https://aur.archlinux.org/rpc/?v=5&type=info&arg=novel-editor-bin")
          if echo "$RESULT" | jq -e '.resultcount > 0' > /dev/null; then
            echo "âœ… novel-editor-bin found in AUR"
            echo "$RESULT" | jq '.results[0] | {name, version, description}'
          else
            echo "âš  novel-editor-bin not found in AUR"
          fi

  # PPA éªŒè¯ (Ubuntu)
  verify-ppa:
    needs: get-version
    runs-on: ubuntu-latest
    steps:
      - name: Verify PPA availability
        run: |
          echo "ğŸ” Checking PPA availability..."
          echo "âš  PPA verification requires manual check"
          echo "PPA URL: https://launchpad.net/~jeason/+archive/ubuntu/novel-editor"

  # COPR éªŒè¯ (Fedora)
  verify-copr:
    needs: get-version
    runs-on: ubuntu-latest
    steps:
      - name: Verify COPR availability
        run: |
          echo "ğŸ” Checking COPR availability..."
          
          # æ£€æŸ¥ COPR API
          RESULT=$(curl -s "https://copr.fedorainfracloud.org/api_3/project/search?query=novel-editor" || echo "{}")
          
          if echo "$RESULT" | grep -q "novel-editor"; then
            echo "âœ… Package found in COPR"
            echo "$RESULT" | head -50
          else
            echo "âš  Package not found in COPR"
          fi

  # OBS éªŒè¯ (openSUSE)
  verify-obs:
    needs: get-version
    runs-on: ubuntu-latest
    steps:
      - name: Verify OBS availability
        run: |
          echo "ğŸ” Checking openSUSE OBS availability..."
          echo "âš  OBS verification requires manual check"
          echo "OBS URL: https://build.opensuse.org/package/show/home:jeason/novel-editor"

  # Gentoo éªŒè¯
  verify-gentoo:
    needs: get-version
    runs-on: ubuntu-latest
    steps:
      - name: Verify Gentoo overlay
        run: |
          echo "ğŸ” Checking Gentoo overlay availability..."
          echo "âš  Gentoo overlay verification requires manual check"
          echo "Overlay: https://github.com/user/gentoo-overlay"

  # ==================== Web å¹³å° ====================
  
  # Web éƒ¨ç½²éªŒè¯
  verify-web:
    needs: get-version
    runs-on: ubuntu-latest
    steps:
      - name: Verify web deployments
        run: |
          echo "ğŸ” Checking web deployment availability..."
          
          # æ£€æŸ¥å¯èƒ½çš„éƒ¨ç½² URL
          URLS=(
            "https://novel-editor.vercel.app"
            "https://novel-editor.netlify.app"
          )
          
          for URL in "${URLS[@]}"; do
            echo ""
            echo "Checking: $URL"
            STATUS=$(curl -s -o /dev/null -w "%{http_code}" "$URL" || echo "000")
            if [ "$STATUS" = "200" ]; then
              echo "âœ… $URL is accessible (HTTP $STATUS)"
            else
              echo "âš  $URL returned HTTP $STATUS"
            fi
          done

  # ==================== æ±‡æ€»æŠ¥å‘Š ====================
  
  verification-report:
    needs: 
      - get-version
      - verify-windows-msi
      - verify-windows-nsis
      - verify-winget
      - verify-chocolatey
      - verify-scoop
      - verify-macos-arm
      - verify-macos-x64
      - verify-homebrew
      - verify-linux-deb
      - verify-linux-appimage
      - verify-snap
      - verify-flatpak
      - verify-aur
      - verify-ppa
      - verify-copr
      - verify-obs
      - verify-gentoo
      - verify-web
    runs-on: ubuntu-latest
    if: always()
    
    steps:
      - name: Generate comprehensive report
        run: |
          VERSION="${{ needs.get-version.outputs.version }}"
          
          echo ""
          echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
          echo "â•‘           Installation Verification Report                    â•‘"
          echo "â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£"
          echo "â•‘ Version: $VERSION"
          echo "â•‘ Date: $(date -u '+%Y-%m-%d %H:%M:%S UTC')"
          echo "â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£"
          echo "â•‘ WINDOWS PLATFORMS                                             â•‘"
          echo "â• â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•£"
          echo "â•‘ MSI Installer:      ${{ needs.verify-windows-msi.result }}"
          echo "â•‘ NSIS Installer:     ${{ needs.verify-windows-nsis.result }}"
          echo "â•‘ Winget:             ${{ needs.verify-winget.result }}"
          echo "â•‘ Chocolatey:         ${{ needs.verify-chocolatey.result }}"
          echo "â•‘ Scoop:              ${{ needs.verify-scoop.result }}"
          echo "â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£"
          echo "â•‘ MACOS PLATFORMS                                               â•‘"
          echo "â• â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•£"
          echo "â•‘ DMG (ARM64):        ${{ needs.verify-macos-arm.result }}"
          echo "â•‘ DMG (x64):          ${{ needs.verify-macos-x64.result }}"
          echo "â•‘ Homebrew:           ${{ needs.verify-homebrew.result }}"
          echo "â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£"
          echo "â•‘ LINUX PLATFORMS                                               â•‘"
          echo "â• â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•£"
          echo "â•‘ DEB Package:        ${{ needs.verify-linux-deb.result }}"
          echo "â•‘ AppImage:           ${{ needs.verify-linux-appimage.result }}"
          echo "â•‘ Snap Store:         ${{ needs.verify-snap.result }}"
          echo "â•‘ Flatpak/Flathub:    ${{ needs.verify-flatpak.result }}"
          echo "â•‘ AUR (Arch):         ${{ needs.verify-aur.result }}"
          echo "â•‘ PPA (Ubuntu):       ${{ needs.verify-ppa.result }}"
          echo "â•‘ COPR (Fedora):      ${{ needs.verify-copr.result }}"
          echo "â•‘ OBS (openSUSE):     ${{ needs.verify-obs.result }}"
          echo "â•‘ Gentoo:             ${{ needs.verify-gentoo.result }}"
          echo "â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£"
          echo "â•‘ WEB PLATFORMS                                                 â•‘"
          echo "â• â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•£"
          echo "â•‘ Web Deployment:     ${{ needs.verify-web.result }}"
          echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo ""
          
          # ç»Ÿè®¡ç»“æœ
          TOTAL=19
          SUCCESS=0
          FAILED=0
          SKIPPED=0
          
          for result in \
            "${{ needs.verify-windows-msi.result }}" \
            "${{ needs.verify-windows-nsis.result }}" \
            "${{ needs.verify-winget.result }}" \
            "${{ needs.verify-chocolatey.result }}" \
            "${{ needs.verify-scoop.result }}" \
            "${{ needs.verify-macos-arm.result }}" \
            "${{ needs.verify-macos-x64.result }}" \
            "${{ needs.verify-homebrew.result }}" \
            "${{ needs.verify-linux-deb.result }}" \
            "${{ needs.verify-linux-appimage.result }}" \
            "${{ needs.verify-snap.result }}" \
            "${{ needs.verify-flatpak.result }}" \
            "${{ needs.verify-aur.result }}" \
            "${{ needs.verify-ppa.result }}" \
            "${{ needs.verify-copr.result }}" \
            "${{ needs.verify-obs.result }}" \
            "${{ needs.verify-gentoo.result }}" \
            "${{ needs.verify-web.result }}"; do
            case "$result" in
              success) ((SUCCESS++)) ;;
              failure) ((FAILED++)) ;;
              skipped) ((SKIPPED++)) ;;
            esac
          done
          
          echo "ğŸ“Š Summary: $SUCCESS passed, $FAILED failed, $SKIPPED skipped (of $TOTAL)"
          
          if [ "$FAILED" -gt 0 ]; then
            echo "âš  Some verifications failed. Check logs for details."
            exit 1
          else
            echo "âœ… All verifications completed!"
          fi
