# 编辑器用户体验改进实施计划

## 任务列表

- [x] 1. 更新应用图标系统
  - 检查并移除src-tauri/icons目录下的旧图标文件
  - 基于new-icon.png生成完整的图标集合（32x32, 128x128, 256x256, 512x512, ICO格式）
  - 更新src-tauri/tauri.conf.json中的图标配置
  - 审查并更新所有GitHub工作流文件中的图标引用
  - 验证打包流程使用新图标
  - _需求: 1.1, 1.2, 1.3, 1.4, 1.5_

- [ ]* 1.1 为图标引用清理编写属性测试
  - **属性 1: 图标引用清理**
  - **验证: 需求 1.1**

- [ ]* 1.2 为图标生成完整性编写属性测试
  - **属性 2: 图标生成完整性**
  - **验证: 需求 1.2**

- [ ]* 1.3 为Tauri配置更新编写属性测试
  - **属性 3: Tauri配置更新**
  - **验证: 需求 1.3**

- [ ]* 1.4 为工作流图标一致性编写属性测试
  - **属性 4: 工作流图标一致性**
  - **验证: 需求 1.4**

- [x] 2. 精简编辑器格式化功能
  - 识别并移除当前编辑器中除加粗和下划线外的其他格式化选项
  - 实现背景颜色选择功能组件
  - 实现字体颜色选择功能组件
  - 重构编辑器工具栏，仅显示必要的格式化选项
  - 确保格式化效果的正确保存和显示
  - _需求: 2.1, 2.2, 2.3, 2.4, 2.5_

- [ ]* 2.1 为工具栏选项限制编写属性测试
  - **属性 5: 工具栏选项限制**
  - **验证: 需求 2.1**

- [ ]* 2.2 为格式化往返一致性编写属性测试
  - **属性 6: 格式化往返一致性**
  - **验证: 需求 2.5**

- [ ] 3. 修复界面横向溢出问题
  - 实现溢出检测工具，识别导致横向滚动的元素
  - 分析并修复根布局组件的宽度设置
  - 调整侧边栏、编辑器和其他主要组件的响应式布局
  - 确保应用在不同窗口尺寸下都能完全适应
  - 验证修复后所有内容都在窗口内可见
  - _需求: 3.1, 3.2, 3.3, 3.4, 3.5_

- [ ]* 3.1 为窗口适应性编写属性测试
  - **属性 7: 窗口适应性**
  - **验证: 需求 3.1**

- [ ]* 3.2 为溢出检测准确性编写属性测试
  - **属性 8: 溢出检测准确性**
  - **验证: 需求 3.2**

- [ ]* 3.3 为响应式布局调整编写属性测试
  - **属性 9: 响应式布局调整**
  - **验证: 需求 3.3**

- [ ]* 3.4 为内容可见性保证编写属性测试
  - **属性 10: 内容可见性保证**
  - **验证: 需求 3.4**

- [x] 4. 增强导出功能支持Tauri应用
  - 检测当前运行环境（Tauri vs 浏览器）
  - 实现Tauri环境下的文件系统API导出功能
  - 创建统一的导出接口，支持两种环境
  - 添加文件保存对话框和错误处理
  - 确保导出功能在桌面应用中正常工作
  - _需求: 4.1, 4.2, 4.3, 4.4, 4.5_

- [ ]* 4.1 为Tauri环境API使用编写属性测试
  - **属性 11: Tauri环境API使用**
  - **验证: 需求 4.1**

- [ ]* 4.2 为导出文件验证编写属性测试
  - **属性 12: 导出文件验证**
  - **验证: 需求 4.3**

- [ ]* 4.3 为导出错误处理编写属性测试
  - **属性 13: 导出错误处理**
  - **验证: 需求 4.4**

- [ ]* 4.4 为环境适应性编写属性测试
  - **属性 14: 环境适应性**
  - **验证: 需求 4.5**

- [ ] 5. 重构绘图模块存储和行为
  - 将绘图数据从场景级别迁移到书籍级别存储
  - 修改绘图功能，每次点击创建新的空白绘图
  - 调整Excalidraw组件尺寸，使其与写作窗口大小一致
  - 解决Excalidraw的最小尺寸限制问题
  - 在右侧边栏添加绘图名称显示和管理功能
  - _需求: 5.1, 5.2, 5.3, 5.4, 5.5_

- [ ]* 5.1 为绘图存储迁移编写属性测试
  - **属性 15: 绘图存储迁移**
  - **验证: 需求 5.1**

- [ ]* 5.2 为新绘图创建编写属性测试
  - **属性 16: 新绘图创建**
  - **验证: 需求 5.2**

- [ ]* 5.3 为绘图窗口尺寸同步编写属性测试
  - **属性 17: 绘图窗口尺寸同步**
  - **验证: 需求 5.3**

- [ ]* 5.4 为绘图侧边栏显示编写属性测试
  - **属性 18: 绘图侧边栏显示**
  - **验证: 需求 5.5**

- [ ] 6. 整合Wiki系统（合并角色和地图功能）
  - 设计统一的Wiki数据结构
  - 将现有的角色和地图数据迁移到Wiki系统
  - 创建Wiki条目编辑界面，支持富文本编辑
  - 实现Wiki条目的分类、标签和搜索功能
  - 在编辑页面中添加Wiki条目引用功能
  - _需求: 6.1, 6.2, 6.3, 6.4, 6.5_

- [ ]* 6.1 为Wiki条目创建支持编写属性测试
  - **属性 19: Wiki条目创建支持**
  - **验证: 需求 6.2**

- [ ]* 6.2 为Wiki引用功能编写属性测试
  - **属性 20: Wiki引用功能**
  - **验证: 需求 6.4**

- [ ] 7. 简化界面布局
  - 移除书籍管理侧边栏下方的重复"更多"按钮
  - 保留活动栏下方的"更多"按钮功能
  - 验证所有功能在简化后仍然可访问
  - 优化界面的视觉层次和布局
  - _需求: 7.1, 7.2, 7.3, 7.4, 7.5_

- [ ]* 7.1 为更多按钮功能完整性编写属性测试
  - **属性 21: 更多按钮功能完整性**
  - **验证: 需求 7.2**

- [ ]* 7.2 为功能可访问性保持编写属性测试
  - **属性 22: 功能可访问性保持**
  - **验证: 需求 7.3**

- [ ] 8. 移除引导功能
  - 识别并移除右上角的引导UI组件
  - 清理相关的引导代码和状态管理
  - 确保移除引导功能不影响其他功能
  - 优化移除引导后的界面布局
  - _需求: 8.1, 8.2, 8.3, 8.4, 8.5_

- [ ]* 8.1 为引导代码清理影响编写属性测试
  - **属性 23: 引导代码清理影响**
  - **验证: 需求 8.2**

- [ ]* 8.2 为应用稳定性保持编写属性测试
  - **属性 24: 应用稳定性保持**
  - **验证: 需求 8.5**

- [ ] 9. 修复设置页面滚动问题
  - 分析设置页面的滚动行为和布局结构
  - 修复活动栏在页面滚动时的位置问题
  - 确保只有内容区域可滚动，活动栏保持固定
  - 验证修复后的滚动体验和布局稳定性
  - _需求: 9.1, 9.2, 9.3, 9.4, 9.5_

- [ ]* 9.1 为活动栏固定位置编写属性测试
  - **属性 25: 活动栏固定位置**
  - **验证: 需求 9.1**

- [ ]* 9.2 为滚动区域限制编写属性测试
  - **属性 26: 滚动区域限制**
  - **验证: 需求 9.2**

- [ ]* 9.3 为布局稳定性编写属性测试
  - **属性 27: 布局稳定性**
  - **验证: 需求 9.3**

- [ ]* 9.4 为设置选项可访问性编写属性测试
  - **属性 28: 设置选项可访问性**
  - **验证: 需求 9.5**

- [ ] 10. 第一次检查点 - 核心功能验证
  - 确保所有测试通过，如有问题请询问用户

- [ ] 11. 集成测试和跨平台验证
  - 编写端到端测试验证完整的用户工作流程
  - 测试图标更新到打包的完整流程
  - 验证编辑器功能在不同平台下的一致性
  - 测试绘图和Wiki系统的数据迁移完整性
  - 验证导出功能在Tauri和浏览器环境下的正确性
  - _需求: 1.1-9.5 (全部)_

- [ ]* 11.1 编写跨平台集成测试套件
  - 测试完整的用户工作流程
  - 验证功能模块协作
  - 测试数据迁移和持久化

- [ ] 12. 最终检查点 - 确保所有测试通过
  - 确保所有测试通过，如有问题请询问用户