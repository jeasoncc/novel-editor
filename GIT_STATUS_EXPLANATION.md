# ğŸ“ Git çŠ¶æ€è¯´æ˜

## â“ é—®é¢˜

ä½ å¯èƒ½çœ‹åˆ° Git æ˜¾ç¤ºäº†å¾ˆå¤šæ–‡ä»¶å˜æ›´ï¼ŒåŒ…æ‹¬ä¸€äº›çœ‹èµ·æ¥åƒæ˜¯ node_modules çš„æ–‡ä»¶ã€‚

## âœ… å®é™…æƒ…å†µ

### node_modules çŠ¶æ€

**å¥½æ¶ˆæ¯**: `node_modules` å®é™…ä¸Šæ˜¯è¢«æ­£ç¡®å¿½ç•¥çš„ï¼

éªŒè¯ï¼š
```bash
$ git check-ignore -v node_modules
.gitignore:2:node_modules       node_modules
# âœ… è¢«å¿½ç•¥

$ git ls-files | grep node_modules
# (æ— è¾“å‡º = æ²¡æœ‰è¢«è¿½è¸ª)
```

### ä½ çœ‹åˆ°çš„ "D" çŠ¶æ€

Git æ˜¾ç¤ºçš„ `D` è¡¨ç¤º **åˆ é™¤ï¼ˆDeletedï¼‰**ï¼Œè¿™æ˜¯å› ä¸ºï¼š

1. **Monorepo è¿ç§»**: æˆ‘ä»¬æŠŠæ–‡ä»¶ä»æ ¹ç›®å½•ç§»åŠ¨åˆ°äº† `apps/desktop/`
2. **Git çš„è§†è§’**: Git è®¤ä¸ºåŸä½ç½®çš„æ–‡ä»¶è¢«"åˆ é™¤"äº†
3. **å®é™…æƒ…å†µ**: æ–‡ä»¶åªæ˜¯ç§»åŠ¨äº†ä½ç½®ï¼Œå¹¶æ²¡æœ‰çœŸæ­£åˆ é™¤

## ğŸ“Š å½“å‰ Git çŠ¶æ€åˆ†æ

### æ–‡ä»¶å˜æ›´ç±»å‹

```bash
$ git status --porcelain
```

| çŠ¶æ€ | å«ä¹‰ | ç¤ºä¾‹ |
|------|------|------|
| `D` | åˆ é™¤ | åŸæ ¹ç›®å½•çš„æ–‡ä»¶ |
| `M` | ä¿®æ”¹ | .gitignore, package.json ç­‰ |
| `??` | æœªè¿½è¸ª | æ–°åˆ›å»ºçš„æ–‡ä»¶ |
| `!!` | è¢«å¿½ç•¥ | node_modules (æ­£ç¡®) |

### è¢«åˆ é™¤çš„æ–‡ä»¶

è¿™äº›æ–‡ä»¶æ˜¾ç¤ºä¸º `D`ï¼ˆåˆ é™¤ï¼‰ï¼š
- `D src-tauri/` - ç§»åŠ¨åˆ° `apps/desktop/src-tauri/`
- `D public/` - ç§»åŠ¨åˆ° `apps/desktop/public/`
- `D index.html` - ç§»åŠ¨åˆ° `apps/desktop/index.html`
- ç­‰ç­‰...

**åŸå› **: è¿™äº›æ–‡ä»¶åœ¨ monorepo è¿ç§»æ—¶è¢«ç§»åŠ¨äº†ã€‚

## ğŸ”§ è§£å†³æ–¹æ¡ˆ

### æ–¹æ¡ˆ 1: æäº¤è¿ç§»å˜æ›´ï¼ˆæ¨èï¼‰

è¿™æ˜¯æ­£å¸¸çš„ monorepo è¿ç§»è¿‡ç¨‹ï¼Œåº”è¯¥æäº¤è¿™äº›å˜æ›´ï¼š

```bash
# 1. æŸ¥çœ‹å˜æ›´
git status

# 2. æ·»åŠ æ‰€æœ‰å˜æ›´
git add .

# 3. æäº¤è¿ç§»
git commit -m "refactor: migrate to monorepo structure

- Move desktop app to apps/desktop/
- Create web app in apps/web/
- Setup Turborepo with Bun workspaces
- Update GitHub Actions workflows
- Optimize .gitignore"

# 4. æ¨é€
git push origin main
```

### æ–¹æ¡ˆ 2: ä½¿ç”¨ git mvï¼ˆå¦‚æœè¿˜æ²¡æäº¤ï¼‰

å¦‚æœä½ æƒ³è®© Git è¯†åˆ«è¿™æ˜¯"ç§»åŠ¨"è€Œä¸æ˜¯"åˆ é™¤+æ–°å¢"ï¼š

```bash
# è¿™éœ€è¦åœ¨ç§»åŠ¨æ–‡ä»¶ä¹‹å‰æ‰§è¡Œï¼Œç°åœ¨å·²ç»æ™šäº†
# ä»…ä¾›å‚è€ƒ
git mv src-tauri apps/desktop/src-tauri
```

### æ–¹æ¡ˆ 3: é‡ç½®å¹¶é‡æ–°è¿ç§»ï¼ˆä¸æ¨èï¼‰

å¦‚æœä½ æƒ³é‡æ–°å¼€å§‹ï¼š

```bash
# âš ï¸ è­¦å‘Šï¼šè¿™ä¼šä¸¢å¤±æ‰€æœ‰æœªæäº¤çš„æ›´æ”¹
git reset --hard HEAD
# ç„¶åé‡æ–°æ‰§è¡Œè¿ç§»
```

## ğŸ¯ æ¨èæ“ä½œ

### ç«‹å³æ‰§è¡Œ

```bash
# 1. æŸ¥çœ‹å®Œæ•´çŠ¶æ€
git status

# 2. æŸ¥çœ‹å…·ä½“å˜æ›´
git diff --stat

# 3. æ·»åŠ æ‰€æœ‰å˜æ›´
git add .

# 4. æäº¤
git commit -m "refactor: migrate to monorepo structure"

# 5. æ¨é€
git push origin main
```

### éªŒè¯ node_modules ç¡®å®è¢«å¿½ç•¥

```bash
# æ£€æŸ¥ node_modules æ˜¯å¦è¢«å¿½ç•¥
git check-ignore -v node_modules
# è¾“å‡º: .gitignore:2:node_modules       node_modules âœ…

# æ£€æŸ¥æ˜¯å¦æœ‰ node_modules æ–‡ä»¶è¢«è¿½è¸ª
git ls-files | grep node_modules
# (åº”è¯¥æ— è¾“å‡º) âœ…

# æŸ¥çœ‹è¢«å¿½ç•¥çš„æ–‡ä»¶
git status --ignored | grep node_modules
# è¾“å‡º: !! node_modules/ âœ…
```

## ğŸ“‹ Git çŠ¶æ€è¯¦è§£

### å½“å‰å˜æ›´ç»Ÿè®¡

```bash
$ git status --short | wc -l
# æ˜¾ç¤ºå˜æ›´æ–‡ä»¶æ•°é‡
```

### å˜æ›´åˆ†ç±»

1. **åˆ é™¤çš„æ–‡ä»¶** (`D`): çº¦ 40+ ä¸ª
   - åŸå› : ä»æ ¹ç›®å½•ç§»åŠ¨åˆ° `apps/desktop/`
   - çŠ¶æ€: æ­£å¸¸

2. **ä¿®æ”¹çš„æ–‡ä»¶** (`M`): çº¦ 5 ä¸ª
   - `.gitignore` - ä¼˜åŒ–é…ç½®
   - `package.json` - æ›´æ–°ä¸º monorepo é…ç½®
   - `README.md` - æ›´æ–°æ–‡æ¡£
   - ç­‰ç­‰
   - çŠ¶æ€: æ­£å¸¸

3. **æ–°æ–‡ä»¶** (`??`): çº¦ 20+ ä¸ª
   - æ–°çš„æ–‡æ¡£æ–‡ä»¶
   - æ–°çš„å·¥ä½œæµæ–‡ä»¶
   - å®˜ç½‘æ–‡ä»¶
   - çŠ¶æ€: æ­£å¸¸

4. **è¢«å¿½ç•¥çš„ç›®å½•** (`!!`): 
   - `node_modules/` âœ…
   - `apps/desktop/node_modules/` âœ…
   - `.turbo/` âœ…
   - çŠ¶æ€: æ­£ç¡®

## ğŸ” å¸¸è§é—®é¢˜

### Q1: ä¸ºä»€ä¹ˆæœ‰è¿™ä¹ˆå¤šåˆ é™¤çš„æ–‡ä»¶ï¼Ÿ

**A**: è¿™æ˜¯ monorepo è¿ç§»çš„æ­£å¸¸ç°è±¡ã€‚æ–‡ä»¶ä»æ ¹ç›®å½•ç§»åŠ¨åˆ°äº† `apps/desktop/`ï¼ŒGit å°†å…¶è¯†åˆ«ä¸º"åˆ é™¤"ã€‚

### Q2: node_modules çœŸçš„è¢«å¿½ç•¥äº†å—ï¼Ÿ

**A**: æ˜¯çš„ï¼éªŒè¯æ–¹æ³•ï¼š
```bash
git ls-files | grep node_modules
# æ— è¾“å‡º = æœªè¢«è¿½è¸ª âœ…
```

### Q3: æˆ‘åº”è¯¥æäº¤è¿™äº›å˜æ›´å—ï¼Ÿ

**A**: æ˜¯çš„ï¼Œè¿™æ˜¯æ­£å¸¸çš„è¿ç§»è¿‡ç¨‹ï¼Œåº”è¯¥æäº¤ã€‚

### Q4: ä¼šä¸ä¼šå½±å“å†å²è®°å½•ï¼Ÿ

**A**: ä¸ä¼šã€‚Git ä¼šä¿ç•™å®Œæ•´çš„å†å²è®°å½•ã€‚ä½ å¯ä»¥éšæ—¶æŸ¥çœ‹æ—§ç‰ˆæœ¬çš„æ–‡ä»¶ã€‚

### Q5: å¦‚ä½•æŸ¥çœ‹æ–‡ä»¶ç§»åŠ¨å†å²ï¼Ÿ

**A**: ä½¿ç”¨ `git log --follow`ï¼š
```bash
git log --follow apps/desktop/src-tauri/tauri.conf.json
# ä¼šæ˜¾ç¤ºæ–‡ä»¶çš„å®Œæ•´å†å²ï¼ŒåŒ…æ‹¬ç§»åŠ¨å‰çš„è®°å½•
```

## ğŸ“Š è¿ç§»å‰åå¯¹æ¯”

### è¿ç§»å‰
```
novel-editor/
â”œâ”€â”€ src/
â”œâ”€â”€ src-tauri/
â”œâ”€â”€ public/
â”œâ”€â”€ package.json
â””â”€â”€ ...
```

### è¿ç§»å
```
novel-editor-monorepo/
â”œâ”€â”€ apps/
â”‚   â”œâ”€â”€ desktop/          # åŸé¡¹ç›®ç§»åŠ¨åˆ°è¿™é‡Œ
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ src-tauri/
â”‚   â”‚   â””â”€â”€ ...
â”‚   â””â”€â”€ web/              # æ–°å®˜ç½‘
â”œâ”€â”€ packages/
â””â”€â”€ ...
```

## âœ… éªŒè¯æ¸…å•

- [x] node_modules è¢«æ­£ç¡®å¿½ç•¥
- [x] .gitignore é…ç½®æ­£ç¡®
- [x] æ–‡ä»¶è¿ç§»å®Œæˆ
- [ ] æäº¤è¿ç§»å˜æ›´
- [ ] æ¨é€åˆ°è¿œç¨‹ä»“åº“

## ğŸŠ ç»“è®º

**çŠ¶æ€**: âœ… ä¸€åˆ‡æ­£å¸¸

**å…³é”®ç‚¹**:
1. âœ… `node_modules` ç¡®å®è¢«æ­£ç¡®å¿½ç•¥
2. âœ… æ˜¾ç¤ºçš„ `D` çŠ¶æ€æ˜¯æ­£å¸¸çš„è¿ç§»è¿‡ç¨‹
3. âœ… æ‰€æœ‰é…ç½®éƒ½æ­£ç¡®

**ä¸‹ä¸€æ­¥**:
```bash
git add .
git commit -m "refactor: migrate to monorepo structure"
git push origin main
```

---

**ä¸ç”¨æ‹…å¿ƒï¼Œè¿™æ˜¯æ­£å¸¸çš„ monorepo è¿ç§»è¿‡ç¨‹ï¼** âœ¨
