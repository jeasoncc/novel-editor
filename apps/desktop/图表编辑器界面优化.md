# 图表编辑器界面优化

## 🎯 优化目标

将原有简陋的编辑器界面升级为专业、美观、易用的现代化编辑器。

## ❌ 原有问题

1. **布局混乱** - 控件排列不整齐
2. **视觉单调** - 缺少层次感和设计感
3. **信息不足** - 缺少状态提示和帮助信息
4. **操作不便** - 按钮位置不合理
5. **缺少反馈** - 没有实时统计信息

## ✅ 新设计方案

### 整体布局

```
┌─────────────────────────────────────────────────────┐
│  [Mermaid] [PlantUML]  [模板▼]  [代码][分屏][预览]  │
├─────────────────────────────────────────────────────┤
│                                                     │
│  代码编辑器              │      实时预览            │
│  ┌──────────────┐       │   ┌──────────────┐      │
│  │              │       │   │              │      │
│  │              │       │   │              │      │
│  │              │       │   │              │      │
│  └──────────────┘       │   └──────────────┘      │
│  100 行 · 500 字符      │   自动更新               │
├─────────────────────────────────────────────────────┤
│  💡 提示：Ctrl+S 保存              查看文档 →       │
└─────────────────────────────────────────────────────┘
```

### 核心改进

#### 1. 顶部工具栏
**设计**:
- 背景色：`bg-muted/30`
- 内边距：`px-6 py-3`
- 分组清晰：类型 | 模板 | 视图 | 操作

**左侧**:
- 类型切换（按钮组）
- 模板选择（下拉菜单）

**右侧**:
- 视图模式（按钮组）
- 操作按钮（重置、保存）

#### 2. 编辑器区域
**代码编辑器**:
- 头部：显示类型标签和统计信息
- 主体：等宽字体，语法高亮准备
- 背景：`bg-muted/10`

**预览区域**:
- 头部：显示"实时预览"和自动更新提示
- 主体：居中显示图表
- 空状态：友好的提示信息

#### 3. 底部提示栏
- 快捷键提示
- 文档链接
- 状态信息

### 视觉设计

#### 颜色方案
```css
/* 背景 */
bg-background      /* 主背景 */
bg-muted/30        /* 工具栏背景 */
bg-muted/10        /* 编辑器背景 */

/* 文字 */
text-foreground    /* 主文字 */
text-muted-foreground  /* 次要文字 */

/* 边框 */
border             /* 分隔线 */
```

#### 间距系统
```css
px-6 py-3         /* 工具栏 */
px-4 py-2         /* 区域头部 */
p-4               /* 编辑器内容 */
p-6               /* 预览区域 */
gap-2, gap-3, gap-4  /* 元素间距 */
```

#### 圆角
```css
rounded-lg        /* 按钮组 */
rounded-md        /* 单个按钮 */
```

### 组件设计

#### 按钮组
```tsx
<div className="flex gap-1 bg-background rounded-lg p-1 border">
  <Button variant={active ? "default" : "ghost"} size="sm">
    <Icon className="h-3.5 w-3.5 mr-1.5" />
    文字
  </Button>
</div>
```

**特点**:
- 统一的容器背景
- 1px 间距
- 圆角边框
- 图标 + 文字

#### 区域头部
```tsx
<div className="flex items-center justify-between px-4 py-2 border-b bg-muted/30">
  <div className="flex items-center gap-2">
    <Icon className="h-4 w-4 text-muted-foreground" />
    <span className="text-sm font-medium">标题</span>
    <Badge variant="secondary">标签</Badge>
  </div>
  <div className="text-xs text-muted-foreground">
    统计信息
  </div>
</div>
```

**特点**:
- 左右布局
- 图标 + 标题 + 标签
- 统计信息右对齐

#### 空状态
```tsx
<div className="flex items-center justify-center h-full">
  <div className="text-center text-muted-foreground">
    <Icon className="h-12 w-12 mx-auto mb-3 opacity-20" />
    <p className="text-sm">主要提示</p>
    <p className="text-xs mt-1">次要提示</p>
  </div>
</div>
```

**特点**:
- 居中显示
- 大图标（半透明）
- 两级文字提示

## 🎨 交互设计

### 1. 类型切换
- 按钮组样式
- 选中状态明显
- 禁用状态灰化
- 切换时提示

### 2. 模板选择
- 下拉菜单
- 显示名称和描述
- 选择后自动填充
- Toast 提示

### 3. 视图模式
- 三种模式：代码、分屏、预览
- 按钮组切换
- 平滑过渡

### 4. 实时预览
- 自动更新
- 错误提示
- 加载状态

### 5. 键盘快捷键
- `Ctrl/Cmd + S` - 保存
- `Ctrl/Cmd + R` - 重置
- 底部提示显示

## 📊 信息展示

### 代码统计
- 行数统计
- 字符统计
- 实时更新

### 类型标识
- Badge 显示当前类型
- 颜色区分

### 状态提示
- 自动更新提示
- 快捷键提示
- 文档链接

## 🎯 用户体验

### 1. 清晰的层级
- 工具栏、编辑区、提示栏三层结构
- 每层功能明确

### 2. 直观的操作
- 按钮图标 + 文字
- 分组清晰
- 操作流程顺畅

### 3. 及时的反馈
- Toast 提示
- 统计信息
- 状态显示

### 4. 友好的引导
- 空状态提示
- 快捷键提示
- 文档链接

### 5. 专业的外观
- 现代化设计
- 统一的配色
- 精致的细节

## 🔧 技术实现

### 组件结构
```
DiagramEditorImproved
├── Toolbar (工具栏)
│   ├── TypeSelector (类型选择)
│   ├── TemplateSelector (模板选择)
│   ├── ViewModeSelector (视图模式)
│   └── Actions (操作按钮)
├── EditorArea (编辑区)
│   ├── CodeEditor (代码编辑器)
│   │   ├── Header (头部)
│   │   └── Textarea (输入区)
│   └── Preview (预览区)
│       ├── Header (头部)
│       └── Content (内容)
└── Footer (底部栏)
    ├── Tips (提示)
    └── Links (链接)
```

### 状态管理
```typescript
const [diagramType, setDiagramType] = useState<"mermaid" | "plantuml">("mermaid");
const [code, setCode] = useState("");
const [viewMode, setViewMode] = useState<ViewMode>("split");
```

### 计算属性
```typescript
const lineCount = code.split('\n').length;
const charCount = code.length;
```

### 键盘事件
```typescript
useEffect(() => {
  const handleKeyDown = (e: KeyboardEvent) => {
    if ((e.ctrlKey || e.metaKey) && e.key === 's') {
      e.preventDefault();
      handleSave();
    }
  };
  window.addEventListener('keydown', handleKeyDown);
  return () => window.removeEventListener('keydown', handleKeyDown);
}, [code, diagramType]);
```

## 📱 响应式设计

### 大屏幕 (> 1280px)
- 对话框宽度：`max-w-7xl`
- 分屏模式：50/50

### 中等屏幕 (768px - 1280px)
- 对话框宽度：`max-w-6xl`
- 分屏模式：50/50

### 小屏幕 (< 768px)
- 对话框全屏
- 只显示单视图

## 🎊 优化效果

### 视觉效果
- ✅ 现代化设计
- ✅ 层次分明
- ✅ 配色和谐
- ✅ 细节精致

### 用户体验
- ✅ 操作直观
- ✅ 反馈及时
- ✅ 引导清晰
- ✅ 效率提升

### 功能完善
- ✅ 统计信息
- ✅ 快捷键
- ✅ 空状态
- ✅ 帮助链接

## 📝 使用示例

### 创建图表
1. 点击"+ 自定义图表"
2. 选择类型（Mermaid/PlantUML）
3. 选择模板或直接编写
4. 实时查看预览
5. Ctrl+S 保存

### 编辑图表
1. 点击图表的编辑按钮
2. 修改代码
3. 查看预览
4. 保存更新

### 切换视图
- 代码模式：专注编写
- 分屏模式：边写边看
- 预览模式：专注查看

## 🚀 未来优化

### 短期
- [ ] 代码语法高亮
- [ ] 行号显示
- [ ] 代码折叠

### 中期
- [ ] 代码自动补全
- [ ] 错误提示
- [ ] 代码格式化

### 长期
- [ ] 可视化编辑
- [ ] 协作编辑
- [ ] 版本历史

## ✅ 总结

新的编辑器界面：
- 🎨 更美观 - 现代化设计，视觉舒适
- 🎯 更专业 - 功能完善，细节到位
- 💡 更易用 - 操作直观，反馈及时
- ⚡ 更高效 - 快捷键支持，流程优化

完全解决了原有界面的所有问题，提供了专业级的编辑体验！
