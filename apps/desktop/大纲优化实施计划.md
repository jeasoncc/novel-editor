# å¤§çº²ç³»ç»Ÿä¼˜åŒ– - å¿«é€Ÿå®æ–½è®¡åˆ’ ğŸš€

## ğŸ¯ ç«‹å³å¯å®æ–½çš„æ”¹è¿›ï¼ˆ1-2å¤©ï¼‰

### 1. è¯¦æƒ…ç¼–è¾‘é¢æ¿ï¼ˆæœ€é‡è¦ï¼ï¼‰

#### å®ç°æ–¹æ¡ˆ
```
å·¦ä¾§ï¼šå¤§çº²æ ‘ï¼ˆ30%å®½åº¦ï¼‰
å³ä¾§ï¼šè¯¦æƒ…é¢æ¿ï¼ˆ70%å®½åº¦ï¼‰

è¯¦æƒ…é¢æ¿å†…å®¹ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [ç« èŠ‚æ ‡é¢˜]                    [Ã—]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ çŠ¶æ€ï¼š[è‰ç¨¿ â–¼] æ ‡ç­¾ï¼š[+æ·»åŠ ]       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ‘˜è¦                                â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ [MinimalEditor]                 â”‚ â”‚
â”‚ â”‚ æ”¯æŒå¯Œæ–‡æœ¬ã€@ æåŠè§’è‰²          â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å…³é”®å‰§æƒ…ç‚¹                          â”‚
â”‚ â€¢ [å¼€ç«¯] ä¸»è§’ç™»åœº                   â”‚
â”‚ â€¢ [å†²çª] é‡åˆ°åæ´¾                   â”‚
â”‚ [+ æ·»åŠ å‰§æƒ…ç‚¹]                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ¶‰åŠè§’è‰²                            â”‚
â”‚ [@å¼ ä¸‰] [@æå››] [+ æ·»åŠ ]           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ åˆ›ä½œç¬”è®°                            â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ [Textarea]                      â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ç»Ÿè®¡                                â”‚
â”‚ å­—æ•°ï¼š1,234 / 5,000 (25%)          â”‚
â”‚ åœºæ™¯ï¼š3ä¸ª                           â”‚
â”‚ æœ€åç¼–è¾‘ï¼š2024-12-02 15:30         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### å…³é”®ä»£ç 
```typescript
// outline-detail-panel.tsx
interface OutlineDetailPanelProps {
  node: ChapterInterface | SceneInterface | null;
  onUpdate: (updates: Partial<OutlineMetadata>) => void;
}

export function OutlineDetailPanel({ node, onUpdate }: Props) {
  if (!node) {
    return <EmptyState />;
  }
  
  return (
    <div className="h-full flex flex-col">
      {/* æ ‡é¢˜æ  */}
      <div className="p-4 border-b">
        <Input value={node.title} onChange={...} />
      </div>
      
      {/* çŠ¶æ€å’Œæ ‡ç­¾ */}
      <div className="p-4 border-b flex gap-2">
        <StatusSelect value={status} onChange={...} />
        <TagInput tags={tags} onChange={...} />
      </div>
      
      {/* æ‘˜è¦ç¼–è¾‘å™¨ */}
      <div className="p-4 border-b">
        <Label>æ‘˜è¦</Label>
        <MinimalEditor
          editorSerializedState={summary}
          onSerializedChange={handleSummaryChange}
        />
      </div>
      
      {/* å‰§æƒ…ç‚¹ */}
      <div className="p-4 border-b">
        <Label>å…³é”®å‰§æƒ…ç‚¹</Label>
        <PlotPointList points={plotPoints} onChange={...} />
      </div>
      
      {/* è§’è‰²å…³è” */}
      <div className="p-4 border-b">
        <Label>æ¶‰åŠè§’è‰²</Label>
        <CharacterList characters={characters} onChange={...} />
      </div>
      
      {/* ç¬”è®° */}
      <div className="p-4 flex-1">
        <Label>åˆ›ä½œç¬”è®°</Label>
        <Textarea value={notes} onChange={...} />
      </div>
      
      {/* ç»Ÿè®¡ */}
      <div className="p-4 border-t">
        <StatsDisplay node={node} />
      </div>
    </div>
  );
}
```

### 2. çŠ¶æ€ç®¡ç†ç³»ç»Ÿ

#### çŠ¶æ€é€‰æ‹©å™¨
```typescript
// status-select.tsx
const STATUS_OPTIONS = [
  { value: "draft", label: "è‰ç¨¿", color: "gray", icon: FileText },
  { value: "in-progress", label: "è¿›è¡Œä¸­", color: "blue", icon: Edit },
  { value: "completed", label: "å·²å®Œæˆ", color: "green", icon: CheckCircle },
  { value: "needs-revision", label: "éœ€ä¿®æ”¹", color: "yellow", icon: AlertCircle },
  { value: "on-hold", label: "æš‚åœ", color: "orange", icon: Pause },
];

export function StatusSelect({ value, onChange }: Props) {
  const current = STATUS_OPTIONS.find(o => o.value === value);
  
  return (
    <Select value={value} onValueChange={onChange}>
      <SelectTrigger className="w-[140px]">
        <div className="flex items-center gap-2">
          <current.icon className="size-4" />
          <span>{current.label}</span>
        </div>
      </SelectTrigger>
      <SelectContent>
        {STATUS_OPTIONS.map(option => (
          <SelectItem key={option.value} value={option.value}>
            <div className="flex items-center gap-2">
              <option.icon className="size-4" />
              <span>{option.label}</span>
            </div>
          </SelectItem>
        ))}
      </SelectContent>
    </Select>
  );
}
```

#### çŠ¶æ€å¾½ç« 
```typescript
// status-badge.tsx
export function StatusBadge({ status }: { status: Status }) {
  const config = STATUS_CONFIG[status];
  
  return (
    <Badge 
      variant="secondary"
      className={cn(
        "gap-1",
        config.className
      )}
    >
      <config.icon className="size-3" />
      {config.label}
    </Badge>
  );
}
```

### 3. æ ‡ç­¾ç³»ç»Ÿ

#### æ ‡ç­¾è¾“å…¥
```typescript
// tag-input.tsx
export function TagInput({ tags, onChange }: Props) {
  const [input, setInput] = useState("");
  
  const handleAdd = () => {
    if (input.trim() && !tags.includes(input.trim())) {
      onChange([...tags, input.trim()]);
      setInput("");
    }
  };
  
  return (
    <div className="flex flex-wrap gap-2">
      {tags.map(tag => (
        <Badge key={tag} variant="secondary">
          {tag}
          <X 
            className="ml-1 size-3 cursor-pointer" 
            onClick={() => onChange(tags.filter(t => t !== tag))}
          />
        </Badge>
      ))}
      <Input
        value={input}
        onChange={e => setInput(e.target.value)}
        onKeyDown={e => e.key === "Enter" && handleAdd()}
        placeholder="æ·»åŠ æ ‡ç­¾..."
        className="w-24 h-6"
      />
    </div>
  );
}
```

### 4. å‰§æƒ…ç‚¹ç¼–è¾‘å™¨

```typescript
// plot-point-editor.tsx
interface PlotPoint {
  id: string;
  type: "setup" | "conflict" | "climax" | "resolution";
  description: string;
  order: number;
}

export function PlotPointEditor({ points, onChange }: Props) {
  const [editing, setEditing] = useState<string | null>(null);
  
  return (
    <div className="space-y-2">
      {points.map(point => (
        <div key={point.id} className="flex items-center gap-2">
          <Select value={point.type} onChange={...}>
            <SelectItem value="setup">å¼€ç«¯</SelectItem>
            <SelectItem value="conflict">å†²çª</SelectItem>
            <SelectItem value="climax">é«˜æ½®</SelectItem>
            <SelectItem value="resolution">ç»“å±€</SelectItem>
          </Select>
          
          {editing === point.id ? (
            <Input
              value={point.description}
              onChange={...}
              onBlur={() => setEditing(null)}
              autoFocus
            />
          ) : (
            <span onClick={() => setEditing(point.id)}>
              {point.description}
            </span>
          )}
          
          <Button
            size="icon-sm"
            variant="ghost"
            onClick={() => handleDelete(point.id)}
          >
            <Trash2 className="size-4" />
          </Button>
        </div>
      ))}
      
      <Button
        size="sm"
        variant="outline"
        onClick={handleAdd}
      >
        <Plus className="size-4 mr-1" />
        æ·»åŠ å‰§æƒ…ç‚¹
      </Button>
    </div>
  );
}
```

## ğŸ¨ UI æ”¹è¿›ï¼ˆç«‹å³å¯åšï¼‰

### 1. æ ‘å½¢è§†å›¾å¢å¼º

```typescript
// æ·»åŠ çŠ¶æ€å›¾æ ‡å’Œè¿›åº¦æ¡
<div className="flex items-center gap-2">
  <StatusBadge status={chapter.status} />
  <span>{chapter.title}</span>
  <Progress value={chapter.progress} className="w-20" />
  <span className="text-xs text-muted-foreground">
    {chapter.wordCount} / {chapter.targetWordCount}
  </span>
</div>
```

### 2. å¡ç‰‡è§†å›¾å¢å¼º

```typescript
// æ·»åŠ æ›´å¤šä¿¡æ¯
<Card>
  <CardHeader>
    <div className="flex items-center justify-between">
      <CardTitle>{chapter.title}</CardTitle>
      <StatusBadge status={chapter.status} />
    </div>
  </CardHeader>
  <CardContent>
    <p className="text-sm text-muted-foreground line-clamp-2">
      {chapter.summary}
    </p>
    <div className="flex items-center gap-2 mt-2">
      {chapter.tags.map(tag => (
        <Badge key={tag} variant="outline">{tag}</Badge>
      ))}
    </div>
    <div className="flex items-center justify-between mt-4 text-xs">
      <span>{chapter.sceneCount} åœºæ™¯</span>
      <span>{chapter.wordCount} å­—</span>
    </div>
  </CardContent>
</Card>
```

## ğŸ“Š æ•°æ®ç»“æ„æ›´æ–°

### æ‰©å±• OutlineMetadata

```typescript
// åœ¨ schema-outline.ts ä¸­æ›´æ–°
export interface OutlineMetadata {
  // çŠ¶æ€
  status: "draft" | "in-progress" | "completed" | "needs-revision" | "on-hold";
  
  // æ‘˜è¦ï¼ˆå¯Œæ–‡æœ¬ï¼‰
  summary?: SerializedEditorState;
  
  // å‰§æƒ…ç‚¹
  plotPoints?: PlotPoint[];
  
  // è§’è‰²å…³è”
  characters?: string[]; // è§’è‰²IDæ•°ç»„
  
  // åœ°ç‚¹
  locations?: string[];
  
  // æ ‡ç­¾
  tags?: string[];
  
  // ç¬”è®°
  notes?: string;
  
  // ç»Ÿè®¡
  wordCount?: number;
  targetWordCount?: number;
  progress?: number; // 0-100
  
  // æ—¶é—´çº¿
  storyTime?: string;
  
  // å…ƒæ•°æ®
  createdAt?: string;
  updatedAt?: string;
}

export interface PlotPoint {
  id: string;
  type: "setup" | "conflict" | "climax" | "resolution";
  description: string;
  order: number;
}
```

### æ›´æ–°æ•°æ®åº“ Schema

```typescript
// åœ¨ schema.ts ä¸­æ·»åŠ 
export interface ChapterInterface {
  // ... ç°æœ‰å­—æ®µ
  
  // å¤§çº²å…ƒæ•°æ®
  outline?: OutlineMetadata;
}

export interface SceneInterface {
  // ... ç°æœ‰å­—æ®µ
  
  // å¤§çº²å…ƒæ•°æ®
  outline?: OutlineMetadata;
}
```

## ğŸ”§ å®æ–½æ­¥éª¤

### Day 1ï¼šæ ¸å¿ƒåŠŸèƒ½
1. âœ… åˆ›å»º `outline-detail-panel.tsx`
2. âœ… åˆ›å»º `status-select.tsx`
3. âœ… åˆ›å»º `tag-input.tsx`
4. âœ… æ›´æ–°æ•°æ®ç»“æ„
5. âœ… é›†æˆåˆ° `outline-view.tsx`

### Day 2ï¼šå¢å¼ºåŠŸèƒ½
1. âœ… åˆ›å»º `plot-point-editor.tsx`
2. âœ… åˆ›å»º `character-selector.tsx`
3. âœ… æ·»åŠ ç»Ÿè®¡æ˜¾ç¤º
4. âœ… ä¼˜åŒ– UI æ ·å¼
5. âœ… æµ‹è¯•å’Œä¿®å¤

## ğŸ’¡ å¿«é€ŸåŸå‹

æˆ‘å¯ä»¥ç«‹å³å¸®ä½ å®ç°ï¼š
1. **è¯¦æƒ…ç¼–è¾‘é¢æ¿** - æœ€æ ¸å¿ƒçš„åŠŸèƒ½
2. **çŠ¶æ€ç®¡ç†ç³»ç»Ÿ** - æå‡å¯ç”¨æ€§
3. **æ ‡ç­¾ç³»ç»Ÿ** - ä¾¿äºç»„ç»‡

è¿™ä¸‰ä¸ªåŠŸèƒ½å®ç°åï¼Œå¤§çº²ç³»ç»Ÿçš„å®ç”¨æ€§å°†æå‡ 10 å€ï¼

è¦ä¸è¦æˆ‘ç°åœ¨å°±å¼€å§‹å®ç°ï¼Ÿæˆ‘å»ºè®®ä»è¯¦æƒ…ç¼–è¾‘é¢æ¿å¼€å§‹ï¼
